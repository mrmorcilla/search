<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>Búsqueda rápida YouTube</title>
</head>
<body>
<script>
  async function buscarYRedirigir() {
    const params = new URLSearchParams(window.location.search);
    const query = params.get('link');
    if(!query) {
      document.body.innerHTML = '<p>Falta el parámetro <code>link</code> para buscar.</p>';
      return;
    }
    try {
      // Escapamos query para URL
      const q = encodeURIComponent(query);

      // Fetch a la página de búsqueda de YouTube
      const response = await fetch(`https://www.youtube.com/results?search_query=${q}`, {mode: 'cors'});
      const text = await response.text();

      // Buscar el primer video ID en el HTML con regex
      const match = text.match(/"videoId":"([a-zA-Z0-9_-]{11})"/);
      if(match && match[1]) {
        const videoId = match[1];
        window.location.href = `https://www.youtube.com/watch?v=${videoId}`;
      } else {
        document.body.innerHTML = '<p>No se encontró ningún video para esa búsqueda.</p>';
      }
    } catch(e) {
      document.body.innerHTML = `<p>Error al buscar videos: ${e.message}</p>`;
    }
  }

  buscarYRedirigir();
</script>
</body>
</html>
